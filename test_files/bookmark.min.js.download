$(".bookmark").on("click",function(){var e,t,n=$("#bmRedirect").attr("value");parseInt($("#isBookmarkLoggedIn").val())?(e=$("#enbm").attr("value"),t=location.origin+"/api/v1/bookmark/update/"+e,console.log("bookmarkApiUrl: ",t),$.get(t,function(){}).done(function(e){console.log("data: ",e);var t=$(".bookmark div"),n="btn--bookmark--big";0<t.length&&(t.hasClass(n)?t.attr("class","btn--bookmarked--big"):t.attr("class",n))}).fail(function(e){console.log("fail: ",e)})):(console.log("redirectURL: ",n),window.location.href=n)}),$("#trigger").bind("click touch",function(){$("#tooltip").show()}),$(document).bind("click touch",function(e){$(e.target).parents().addBack().is("#trigger")||$("#tooltip").hide()}),$("#tooltip").bind("click touch",function(e){e.stopPropagation()}),window.addEventListener("beforeunload",function(e){countSelected=$("input[type=checkbox]:checked").length,0<countSelected&&(e.preventDefault(),e.returnValue="")}),$(".undo-delete").click(function(){$(this).find("i.fa").toggleClass("fa-undo fa-trash")}),$("#added-folder-modal").on("hidden.bs.modal",function(){window.location.reload()}),$(document).ready(function(){var l=[],d=[],o=[],n=(l.length,$("li.saved-article").length),a="",c="";function i(e,t){var n=e.split("?");if(2<=n.length){for(var o=encodeURIComponent(t)+"=",l=n[1].split(/[&;]/g),d=l.length;0<d--;)-1!==l[d].lastIndexOf(o,0)&&l.splice(d,1);return e=n[0]+"?"+l.join("&")}return e}$("#allBtn").click(function(){$("li.saved-article").removeClass("editing");var n=$(".bookmark__items .bdelc > input");$.each(n,function(e,t){n[e].checked||(n[e].checked=!0)}),$("li.saved-article").toggleClass("editing"),$("#allBtn").hide(0),$("#deallBtn").show(0),$("#dltBtn").show(0),document.getElementById("dltBtn")&&(document.getElementById("dltBtn").style.opacity="1.0",document.getElementById("dltBtn").style.pointerEvents="visible"),document.getElementById("AddEFolderModal")&&(document.getElementById("AddEFolderModal").style.opacity="1.0",document.getElementById("AddEFolderModal").style.pointerEvents="visible"),0<d.length&&document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="1",document.getElementById("btnAddEFolder").style.pointerEvents="visible"),l=[],a="";var o=$(".bookmark__items .checkmark");$.each(o,function(e,t){var n=$(t).data("value");l.push(n),e+1==o.length?a+=n:a=a+n+"|"})}),$("#deallBtn").click(function(){var n=$(".bookmark__items .bdelc > input");$.each(n,function(e,t){n[e].checked&&(n[e].checked=!1)}),$("#allBtn").show(0),$("#deallBtn").hide(0),document.getElementById("dltBtn")&&(document.getElementById("dltBtn").style.opacity="0.5",document.getElementById("dltBtn").style.pointerEvents="none"),document.getElementById("AddEFolderModal")&&(document.getElementById("AddEFolderModal").style.opacity="0.5",document.getElementById("AddEFolderModal").style.pointerEvents="none"),document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="0.5",document.getElementById("btnAddEFolder").style.pointerEvents="none"),l=[],a=""}),$("#dltBtn").click(function(){countSelected=$(".bookmark__items input[type=checkbox]:checked"),0<countSelected.length?$(".confirmRequest").show(0):alert("Please select at least 1 story")}),$("#btnAddEFolder").click(function(){countSelected=$(".bookmark__items input[type=checkbox]:checked");var e,t,n="";$("#enli").attr("value")&&(n=$("#enli").attr("value")),0<countSelected.length&&0<d.length?(e='{"email":"'+$("#enem").attr("value")+'","storyGuid":"'+a+'","folderID":"'+c+'","orifolderID":"'+n+'"}',t=location.origin+"/api/v1/bookmark/add_to_existing_folder",console.log("bookmarkApiUrl: ",t),console.log("jsonToAPI: ",e),$.ajax({type:"POST",url:t,data:e,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){var t,n;e&&e.status_code&&("1"==e.status_code?(n=$(".bookmark__items .bdelc > input, .folder__item .bdelc > input"),$.each(n,function(e,t){n[e].checked&&(n[e].checked=!1)}),document.getElementById("dltBtn")&&(document.getElementById("dltBtn").style.opacity="0.5",document.getElementById("dltBtn").style.pointerEvents="none"),document.getElementById("AddEFolderModal")&&(document.getElementById("AddEFolderModal").style.opacity="0.5",document.getElementById("AddEFolderModal").style.pointerEvents="none"),document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="0.5",document.getElementById("btnAddEFolder").style.pointerEvents="none"),$.each(o,function(e,t){$("#addedStoriesFolderList").append('<div class="folder__item"><div class="folder__details"><div class="folder__icon"><img src="https://cdn.thestar.com.my/Themes/img/bookmarkfolder-grey.png" alt="Folder"></div><p class=\'folder__name\'>'+t+"</p></div></div>")}),l=[],d=[],o=[],c=a="",$("#added-folder-modal").modal("show")):e.folder_name?(t=e.folder_name.replaceAll("&quot;",'"'),alert("The selected stories have been added into "+t+".")||(n=$(".bookmark__items .bdelc > input, .folder__item .bdelc > input"),$.each(n,function(e,t){n[e].checked&&(n[e].checked=!1)}),window.location.reload())):alert("The story is already added to existing folder."))},failure:function(e){}}),$(".checkmark:after").empty()):alert("Please select at least 1 story")}),$(".bookmark__items .checkmark").click(function(e){var t=$(this).data("value");$(this).parent().parent().parent().parent().toggleClass("editing"),-1!=jQuery.inArray(t,l)?l=l.filter(function(e){return e!==t}):l.push(t),0<l.length?($("#dltBtn").show(0),document.getElementById("dltBtn")&&(document.getElementById("dltBtn").style.opacity="1",document.getElementById("dltBtn").style.pointerEvents="visible"),document.getElementById("AddEFolderModal")&&(document.getElementById("AddEFolderModal").style.opacity="1",document.getElementById("AddEFolderModal").style.pointerEvents="visible"),0<d.length&&document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="1",document.getElementById("btnAddEFolder").style.pointerEvents="visible"),document.getElementById("allBtn")&&(document.getElementById("allBtn").style.opacity="1",document.getElementById("allBtn").style.pointerEvents="visible"),l.length===n?($("#deallBtn").show(0),$("#allBtn").hide(0)):($("#deallBtn").hide(0),$("#allBtn").show(0))):($("#allBtn").show(0),$("#deallBtn").hide(0),document.getElementById("dltBtn")&&(document.getElementById("dltBtn").style.opacity="0.5",document.getElementById("dltBtn").style.pointerEvents="none"),document.getElementById("AddEFolderModal")&&(document.getElementById("AddEFolderModal").style.opacity="0.5",document.getElementById("AddEFolderModal").style.pointerEvents="none"),document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="0.5",document.getElementById("btnAddEFolder").style.pointerEvents="none")),a="",$.each(l,function(e,t){e+1==l.length?a+=t:a=a+t+"|"})}),$(".folder__item .checkmark").click(function(e){var t=$(this).data("value"),n=$(this).data("folder");-1!=jQuery.inArray(t,d)?d=d.filter(function(e){return e!==t}):d.push(t),-1!=jQuery.inArray(n,o)?o=o.filter(function(e){return e!==n}):o.push(n),0<d.length&&0<l.length?document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="1",document.getElementById("btnAddEFolder").style.pointerEvents="visible"):document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="0.5",document.getElementById("btnAddEFolder").style.pointerEvents="none"),c="",$.each(d,function(e,t){e+1==d.length?c+=t:c=c+t+"|"})}),$(".folder__item").click(function(e){var t=$(this).data("value"),n=$(this).data("folder");d.length<1?(-1!=jQuery.inArray(t,d)?d=d.filter(function(e){return e!==t}):d.push(t),-1!=jQuery.inArray(n,o)?o=o.filter(function(e){return e!==n}):o.push(n),0<d.length&&0<l.length?(document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="1",document.getElementById("btnAddEFolder").style.pointerEvents="visible"),$(this).toggleClass("folder--active")):document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="0.5",document.getElementById("btnAddEFolder").style.pointerEvents="none"),c="",$.each(d,function(e,t){e+1==d.length?c+=t:c=c+t+"|"}),$(this).closest(".modal").on("hidden.bs.modal",function(){$(".folder__item").hasClass("folder--active")&&($(".folder__item").removeClass("folder--active"),document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="0.5",document.getElementById("btnAddEFolder").style.pointerEvents="none"),d=[],o=[],c="")})):1==d.length&&($(this).hasClass("folder--active")||$(".folder__item").hasClass("folder--active")&&($(".folder__item").removeClass("folder--active"),d=[],o=[],c="",-1!=jQuery.inArray(t,d)?d=d.filter(function(e){return e!==t}):d.push(t),-1!=jQuery.inArray(n,o)?o=o.filter(function(e){return e!==n}):o.push(n),0<d.length&&0<l.length?(document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="1",document.getElementById("btnAddEFolder").style.pointerEvents="visible"),$(this).toggleClass("folder--active")):document.getElementById("btnAddEFolder")&&(document.getElementById("btnAddEFolder").style.opacity="0.5",document.getElementById("btnAddEFolder").style.pointerEvents="none"),c="",$.each(d,function(e,t){e+1==d.length?c+=t:c=c+t+"|"})))}),$("#yesBtn").click(function(){var e="";$("#enli").attr("value")&&(e=$("#enli").attr("value"));var t='{"email":"'+$("#enem").attr("value")+'","storyGuid":"'+a+'","folderID":"'+e+'"}',n=location.origin+"/api/v1/bookmark/delete";console.log("bookmarkApiUrl: ",n),console.log("jsonToAPI: ",t),$.ajax({type:"POST",url:n,data:t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){var n;e&&(n=$(".bookmark__items .bdelc > input"),$.each(n,function(e,t){n[e].checked&&(n[e].checked=!1)}),window.location.reload())},failure:function(e){}})}),$("#noBtn").click(function(){$(".confirmRequest").hide(0)}),$("#create_folder_button").click(function(){var e,t;$("#c_folder_name").val()?(e='{"email":"'+$("#enem").attr("value")+'","foldername":"'+$("#c_folder_name").val().replaceAll('"',"&quot;")+'"}',t=location.origin+"/api/v1/bookmark/create_folder",console.log("bookmarkApiUrl: ",t),console.log("jsonToAPI: ",e),$.ajax({type:"POST",url:t,data:e,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){var n;e&&e.status_code?"1"==e.status_code?(n=$(".bookmark__items .bdelc > input, .folder__item .bdelc > input"),$.each(n,function(e,t){n[e].checked&&(n[e].checked=!1)}),window.location.reload()):"0"==e.status_code?alert("Folder name already exist."):alert("Invalid folder name."):alert("Invalid folder name."),console.log(e)},failure:function(e){}})):alert("Please enter the folder name.")}),$("#create_sfolder_button").click(function(){countSelected=$(".bookmark__items input[type=checkbox]:checked");var e,t,n="";$("#enli").attr("value")&&(n=$("#enli").attr("value")),$("#c_folder_name").val()&&0<countSelected.length?(e='{"email":"'+$("#enem").attr("value")+'","foldername":"'+$("#c_folder_name").val().replaceAll('"',"&quot;")+'","storyGuid":"'+a+'","orifolderID":"'+n+'"}',t=location.origin+"/api/v1/bookmark/create_folder_with_story",console.log("bookmarkApiUrl: ",t),console.log("jsonToAPI: ",e),$.ajax({type:"POST",url:t,data:e,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){var t,n;e&&e.status_code?"1"==e.status_code?(n=$(".bookmark__items .bdelc > input, .folder__item .bdelc > input"),$.each(n,function(e,t){n[e].checked&&(n[e].checked=!1)}),window.location.reload()):"0"==e.status_code?alert("Folder name already exist."):e.folder_name?(t=e.folder_name.replaceAll("&quot;",'"'),alert("The selected stories have been added into "+t+".")||(n=$(".bookmark__items .bdelc > input, .folder__item .bdelc > input"),$.each(n,function(e,t){n[e].checked&&(n[e].checked=!1)}),window.location.reload())):alert("The story is already added to existing folder."):alert("Invalid folder name."),console.log(e)},failure:function(e){}})):alert("Please enter the folder name.")}),$("#modalCreateFolder").click(function(){$("#create_sfolder_button").hide(),$("#create_folder_button").show()}),$("#modalCreateStoryFolder").click(function(){$("#create_sfolder_button").show(),$("#create_folder_button").hide()}),$(".btn--bookmark").click(function(t){var e,n,o=$(t.target).closest(".row");0<o.length&&(e=o.attr("data-enbm"),n=location.origin+"/api/v1/bookmark/update/"+e,console.log("bookmarkApiUrl:",n),$.get(n,function(){}).done(function(e){console.log("result",e),$(t.target).toggleClass("active")}))}),$(".folder_rename").click(function(e){var t=$(this).data("value");$("#btnRename").removeAttr("data-value"),$("#btnRename").attr("data-value",t)}),$("#btnRename").click(function(){var e,t,n=$(this).data("value");$("#rename_folder_name").val()&&n?(e='{"email":"'+$("#enem").attr("value")+'","folderID":"'+n+'","foldername":"'+$("#rename_folder_name").val().replaceAll('"',"&quot;")+'"}',t=location.origin+"/api/v1/bookmark/rename_folder",console.log("bookmarkApiUrl: ",t),console.log("jsonToAPI: ",e),$.ajax({type:"POST",url:t,data:e,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){var n;e&&e.status_code?"1"==e.status_code?(n=$(".bookmark__items .bdelc > input"),$.each(n,function(e,t){n[e].checked&&(n[e].checked=!1)}),window.location.reload()):alert("Folder name already exist."):alert("Invalid folder name."),console.log(e)},failure:function(e){}})):alert("Please enter the folder name.")}),$(".folder_remove").click(function(e){var t=$(this).data("value"),n=$(this).data("folder");$("#removeFolderName").text(n),$("#btnRemove").removeAttr("data-value"),$("#btnRemove").attr("data-value",t)}),$("#btnRemove").click(function(){var e,t,n=$(this).data("value");n?(e='{"email":"'+$("#enem").attr("value")+'","folderID":"'+n+'"}',t=location.origin+"/api/v1/bookmark/delete_folder",console.log("bookmarkApiUrl: ",t),console.log("jsonToAPI: ",e),$.ajax({type:"POST",url:t,data:e,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){var n;e&&e.status_code&&"1"==e.status_code?(n=$(".bookmark__items .bdelc > input"),$.each(n,function(e,t){n[e].checked&&(n[e].checked=!1)}),window.location.reload()):alert("Failed to delete the folder."),console.log(e)},failure:function(e){}})):alert("Please select the folder to be deleted.")}),$("#bookmarks_sort_box").change(function(){var e=location.href,t="",n=$(this).val();-1<e.indexOf("pgno=")&&"?"==(e=i(e,"pgno")).slice(-1)&&(e=e.substring(0,e.length-1)),e.indexOf("bs=")<0&&e.indexOf("?")<0?t=e+"?bs="+n:e.indexOf("bs=")<0&&-1<e.indexOf("?")?t=e+"&bs="+n:-1<e.indexOf("bs=")&&("?"==(t=i(e,"bs")).slice(-1)&&(t=t.substring(0,t.length-1)),t=t.indexOf("?")<0?t+"?bs="+n:t+"&bs="+n),location.href=t}),$("#bookmarks_filter_by").change(function(){var e=location.href,t="",n=$(this).val().toLowerCase();-1<e.indexOf("pgno=")&&"?"==(e=i(e,"pgno")).slice(-1)&&(e=e.substring(0,e.length-1)),n?e.indexOf("fb=")<0&&e.indexOf("?")<0?t=e+"?fb="+n:e.indexOf("fb=")<0&&-1<e.indexOf("?")?t=e+"&fb="+n:-1<e.indexOf("fb=")&&("?"==(t=i(e,"fb")).slice(-1)&&(t=t.substring(0,t.length-1)),t=t.indexOf("?")<0?t+"?fb="+n:t+"&fb="+n):-1<e.indexOf("fb=")&&"?"==(t=i(e,"fb")).slice(-1)&&(t=t.substring(0,t.length-1)),location.href=t}),$("#library_sort_box").change(function(){var e=location.href,t="",n=$(this).val();-1<e.indexOf("lpgno=")&&"?"==(e=i(e,"lpgno")).slice(-1)&&(e=e.substring(0,e.length-1)),e.indexOf("ls=")<0&&e.indexOf("?")<0?t=e+"?ls="+n:e.indexOf("ls=")<0&&-1<e.indexOf("?")?t=e+"&ls="+n:-1<e.indexOf("ls=")&&("?"==(t=i(e,"ls")).slice(-1)&&(t=t.substring(0,t.length-1)),t=t.indexOf("?")<0?t+"?ls="+n:t+"&ls="+n),location.href=t})});